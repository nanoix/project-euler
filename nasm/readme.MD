Needs some fixes, segmentation fault
